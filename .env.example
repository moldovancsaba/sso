# MongoDB Configuration
MONGODB_URI=mongodb://localhost:27017/sso_db
MONGODB_DB=sso_database
USERS_COLLECTION=users
SESSIONS_COLLECTION=sessions

# CORS Configuration
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001,https://yourdomain.com
CORS_CREDENTIALS=true

# Session Configuration (GENERATE YOUR OWN: openssl rand -base64 32)
SESSION_SECRET=REPLACE_WITH_SECURE_RANDOM_STRING
SESSION_MAX_AGE=86400000
SESSION_SAME_SITE=lax

# JWT Configuration (optional, if using JWTs)
JWT_SECRET=REPLACE_WITH_SECURE_JWT_SECRET
JWT_EXPIRES_IN=24h
JWT_ISSUER=your-sso-service
JWT_AUDIENCE=your-client-applications

# Server Configuration
PORT=3000
HOST=localhost
BASE_PATH=
TRUSTED_PROXIES=

# API Endpoints (customize if needed)
LOGIN_ENDPOINT=/api/auth/login
LOGOUT_ENDPOINT=/api/auth/logout
VALIDATE_ENDPOINT=/api/auth/validate
REGISTER_ENDPOINT=/api/auth/register

# Security Settings
BCRYPT_ROUNDS=12
RATE_LIMIT_MAX=100
RATE_LIMIT_WINDOW=900000
CSRF_PROTECTION=true

# Development Settings
NODE_ENV=development
LOG_LEVEL=info

# Admin session cookie name
ADMIN_SESSION_COOKIE=admin-session

# Cookie domain for subdomain sharing (e.g., .doneisbetter.com)
# CRITICAL: Set this to enable SSO across subdomains (cardmass, playmass, etc.)
SSO_COOKIE_DOMAIN=.doneisbetter.com

# Admin alias email for 'admin' login shortcut
SSO_ADMIN_ALIAS_EMAIL=sso@doneisbetter.com

# Magic link signing secret (generate: openssl rand -base64 32)
ADMIN_MAGIC_SECRET=REPLACE_WITH_SECURE_RANDOM_STRING
# Optional allowlist for magic link emails (comma-separated, lowercased). If empty, allow any existing admin user.
ADMIN_MAGIC_ALLOWED_EMAILS=
# Optional magic link TTL in seconds (script default: 900)
MAGIC_TTL_SECONDS=900

# Dev bypass (development only)
ADMIN_DEV_BYPASS=false
NEXT_PUBLIC_ADMIN_DEV_BYPASS=false
ADMIN_DEV_ROLE=super-admin

# CORS allowed origins for production (new)
SSO_ALLOWED_ORIGINS=https://sso.doneisbetter.com,https://doneisbetter.com

# Base URL used for shareable link generation
SSO_BASE_URL=https://sso.doneisbetter.com

# Rate limiting configuration
RATE_LIMIT_LOGIN_MAX=5           # Max login attempts per window
RATE_LIMIT_LOGIN_WINDOW=900000   # 15 minutes in milliseconds

# Logging configuration
LOG_LEVEL=info                    # Log level: debug, info, warn, error
LOG_FILE_PATH=                    # Optional: path to log file for production

# CSRF protection secret (uses SESSION_SECRET if not set)
CSRF_SECRET=REPLACE_WITH_SECURE_RANDOM_STRING
