# AI Handover — Centralized Design System, Style Audit, and Ongoing Refactors

CreatedAt (UTC): 2025-10-16T17:13:15.000Z
Current Version: 5.15.0
Branch: main
Status: In-flight styling refactor + docs contrast fix pending

Summary
- We implemented a centralized design system in styles/globals.css and migrated major CSS modules.
- We refactored pages/login.js to remove ~38 inline styles, using styles/login.module.css.
- Immediate issues remain: code blocks in docs show white text on white background; pages/register.js still uses inline styles.

Immediate Priorities (Do these next)
1) Fix docs code block contrast (white-on-white bug)
   - Symptom: Example snippet (e.g., “const sso = new SSOClient(...)”) renders white text on white background.
   - Likely cause: docs code block CSS not aligned with design tokens; background/text tokens clash.
   - Resolution approach:
     - Update docs stylesheet (styles/docs.module.css or the docs-specific CSS) to style pre, code blocks using design tokens.
     - Ensure accessible contrast: background var(--bg-surface-secondary) or var(--color-neutral-900) for dark theme, text var(--text-primary) or a token from syntax theme.
     - Apply padding, border-radius, overflow-x auto, and mono font.
     - Verify across all /pages/docs/* routes.

2) Refactor pages/register.js to design system
   - Replace all inline style objects and JS hover/focus handlers with classes from a new styles/register.module.css.
   - Mirror patterns used in login.module.css: pageContainer, card, header/title/subtitle, formGroup/label/input, errorBox/successBox, primaryButton/secondaryButton/link styles, etc.

3) Sweep for remaining inline styles
   - Pages to spot-check after register: /pages/forgot-password.js, /pages/admin/*, docs pages with inlined styles.
   - Replace inline styles with module classes, leverage utility classes from globals.css when suitable.

Detailed Plan
A) Docs Code Block Contrast Fix
- Target files (inspect and update accordingly):
  - styles/docs.module.css (preferred)
  - styles/docs-layout.module.css (if code sections live here)
  - As a fallback, create a focused docs code block section in docs.module.css.
- Add/update rules:
  - pre, code, pre code selectors under doc scope to avoid global bleed.
  - Example (token-based; tune as needed):
    ```css path=null start=null
    /* Docs code blocks */
    .codeBlock,
    .docs :global(pre) {
      background: var(--bg-surface-secondary);
      color: var(--text-primary);
      font-family: var(--font-mono);
      font-size: var(--text-sm);
      line-height: 1.6;
      padding: var(--space-4);
      border: 1px solid var(--border-default);
      border-radius: var(--radius-lg);
      overflow-x: auto;
    }
    .docs :global(code) {
      font-family: var(--font-mono);
    }
    ```
- If dark theme is intended on docs, prefer explicit dark code theme tokens:
  - background: var(--color-neutral-950);
  - color: var(--color-neutral-50);
  - borders/shadows adjusted for dark scheme.
- Validate on pages:
  - /docs, /docs/quickstart, /docs/authentication, /docs/api/*, /docs/examples/*, /docs/security/*

B) Register Page Refactor
- Create styles/register.module.css reusing same token patterns as login.module.css:
  - pageContainer, form card, header/title/subtitle
  - formGroup, label, input, input.error, errorText
  - primaryButton, secondaryButton, linkContainer/link/linkSmall
- Update pages/register.js:
  - Import: import styles from '../styles/register.module.css'
  - Replace inline styles with className mappings.
  - Remove onFocus/onBlur hover handlers; rely on :focus and :hover rules in CSS.
  - Reuse existing form validation UI patterns from login refactor.
- Build and verify UI parity.

C) Global Inline Style Removal Sweep
- Grep for style={{ in /pages to find remaining inline styles.
- For each file:
  - Create a dedicated module in /styles if the page is complex.
  - Otherwise, reuse existing utility classes from globals.css.
- Prioritized targets (estimate):
  - pages/forgot-password.js
  - pages/admin/index.js and any modals/tables inside
  - any remaining documentation pages with inline styles

Design System Reference (short)
- Location: styles/globals.css
- Tokens: semantic backgrounds/text/borders, spacing scale, typography, shadows, radii, transitions.
- Principles:
  - No hardcoded hex in modules. Always use tokens: var(--bg-surface), var(--text-primary), etc.
  - No JS-driven hover/focus for style-only effects. Use :hover/:focus in CSS.
  - Keep spacing/typography on the shared scales for consistency.

Conventions
- CSS Modules per page: styles/<page>.module.css
- Class naming: semantic and component-scoped (e.g., loginCard, modalOverlay, errorBox).
- No inline styles in components.
- Docs-specific styles live in docs.module.css and docs-layout.module.css; prefer scoping under a .docs root container class.

Versioning Workflow (enforced)
- Before committing to GitHub: bump MINOR and reset PATCH (npm version minor --no-git-tag-version), then npm run sync:version, build.
- Before running dev locally: bump PATCH.
- After version change: npm run sync:version to update docs and WARP files.

Verification Checklist per Change
1) npm run build (ensure 0 errors, all pages generated)
2) Manual QA of affected pages (visual contrast, focus states, mobile widths)
3) Confirm no inline style remnants
4) Commit (version bump first), push main

Known Risks / Watchouts
- Dark/light contrast mismatches if tokens are inconsistent per module; resolve by unifying docs code block theme.
- Global CSS leakage into docs; keep code block rules scoped to docs root to avoid admin UI regressions.
- Avoid introducing new inline styles during quick fixes.

Repro Steps for the Reported Bug
- Visit any docs page showing code example (e.g., /docs or /docs/quickstart).
- Observe code block renders white text on white background.
- After fix, verify code block shows readable mono text with adequate contrast.

Next Commits (proposed)
- v5.16.0: Docs code block contrast fix (docs.module.css)
- v5.17.0: Register page refactor (register.module.css + pages/register.js)
- v5.18.0+: Sweep remaining inline styles across pages

Operational Commands
- Build: npm run build
- Dev: npm run dev
- Version bump (minor): npm version minor --no-git-tag-version && npm run sync:version
- Commit: git add -A && git commit -m "vX.Y.Z: <short summary>" && git push origin main

Ownership Hand-off Notes
- No tests (MVP policy). Validate manually.
- Keep all timestamps in docs ISO 8601 UTC with milliseconds.
- Never introduce breadcrumbs per Navigation Design Policy.
- Reuse before creation: check for existing module classes and utilities before adding new ones.

End of handover.
